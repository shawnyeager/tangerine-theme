name: Trigger Site Updates

on:
  push:
    branches:
      - master

jobs:
  trigger-updates:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger shawnyeager-com update
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.SITES_UPDATE_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: 'shawnyeager',
              repo: 'shawnyeager-com',
              workflow_id: 'auto-theme-update-pr.yml',
              ref: 'master'
            });
            console.log('Triggered shawnyeager-com update workflow');

      - name: Trigger shawnyeager-notes update
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.SITES_UPDATE_TOKEN }}
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: 'shawnyeager',
              repo: 'shawnyeager-notes',
              workflow_id: 'auto-theme-update-pr.yml',
              ref: 'master'
            });
            console.log('Triggered shawnyeager-notes update workflow');

      - name: Summary
        run: |
          echo "Theme pushed to master. Site update workflows triggered."
          echo ""
          echo "PRs will be created in ~2-3 minutes:"
          echo "  - https://github.com/shawnyeager/shawnyeager-com/pulls"
          echo "  - https://github.com/shawnyeager/shawnyeager-notes/pulls"
