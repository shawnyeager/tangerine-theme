{{/*
Purpose: CSS, fonts, RSS, sitemap, and favicon resources

Context Expected:
- .Site.Params.favicon_style - Favicon style ("solid" or "outlined")
- .Site.Title - Site title for RSS feed
- .OutputFormats - Available output formats (for RSS link)
*/}}

<!-- Preload critical resources -->
<link rel="preload" href="{{ "fonts/inter-variable.woff2" | relURL }}" as="font" type="font/woff2" crossorigin>
{{- $cssPath := "css/main.css" -}}
{{- $css := (resources.Get $cssPath) -}}
{{- if $css -}}
  {{/* Create non-fingerprinted version for XSLT reference */}}
  {{- $cssPlain := $css | resources.Minify -}}
  {{- $cssPlainPermalink := $cssPlain.RelPermalink -}}

  {{/* Create fingerprinted version for site */}}
  {{- $cssFingerprinted := $css | resources.Minify | resources.Fingerprint -}}
  <link rel="preload" href="{{ $cssFingerprinted.RelPermalink }}" as="style" integrity="{{ $cssFingerprinted.Data.Integrity }}">
{{- else -}}
  <link rel="preload" href="{{ $cssPath | relURL }}" as="style">
{{- end -}}

<!-- CSS -->
{{- if $css -}}
  {{- $cssFingerprinted := $css | resources.Minify | resources.Fingerprint -}}
  <link rel="stylesheet" href="{{ $cssFingerprinted.RelPermalink }}" integrity="{{ $cssFingerprinted.Data.Integrity }}">
{{- else -}}
  <link rel="stylesheet" href="{{ $cssPath | relURL }}">
{{- end -}}

<!-- RSS Feed -->
{{ with .OutputFormats.Get "rss" -}}
{{ printf `<link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }}
{{ end -}}

<!-- Sitemap -->
<link rel="sitemap" type="application/xml" href="{{ "sitemap.xml" | absURL }}" title="Sitemap">

<!-- Favicon (parameterized: solid for .com, outlined for .notes) -->
<!-- SVG favicon for modern browsers (best quality, brand orange color) -->
{{ if eq .Site.Params.favicon_style "outlined" }}
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect x='2' y='2' width='28' height='28' fill='none' stroke='%23F84200' stroke-width='4'/%3E%3C/svg%3E">
{{ else }}
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect x='2' y='2' width='28' height='28' fill='%23F84200'/%3E%3C/svg%3E">
{{ end }}
<!-- File-based favicons for Google and legacy browsers -->
<link rel="icon" type="image/x-icon" href="{{ "favicon.ico" | relURL }}">
<link rel="icon" type="image/png" sizes="32x32" href="{{ "favicon-32x32.png" | relURL }}">
<link rel="icon" type="image/png" sizes="16x16" href="{{ "favicon-16x16.png" | relURL }}">
<link rel="apple-touch-icon" sizes="180x180" href="{{ "apple-touch-icon.png" | relURL }}">
