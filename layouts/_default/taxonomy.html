{{/*
Purpose: Renders taxonomy pages (e.g., /topics/bitcoin/)
Editorial index matching /writing/ â€” type label, title, description.
*/}}

{{ define "main" }}
    {{/* Filter drafts in production */}}
    {{ $pages := .Pages }}
    {{ if not hugo.IsServer }}
        {{ $pages = where $pages "Draft" false }}
    {{ end }}

    {{/* Page title */}}
    <h1 class="page-title">{{ .Title }}</h1>

    <section class="writing-stream">
        {{ range $pages }}
        <article class="writing-item">
            <a href="{{ .RelPermalink }}">
                <span class="writing-item-title">{{ .Title }} <span class="writing-item-type">{{ .Type | singularize }}</span></span>
                {{ with .Params.description }}<span class="writing-item-desc">{{ . }}</span>{{ end }}
            </a>
        </article>
        {{ end }}
    </section>

    {{/* Back link */}}
    {{ $backURL := "/writing/" }}
    {{ $backText := "All writing" }}
    {{- partial "content-nav.html" (dict "back_url" ($backURL | relURL) "back_text" $backText) -}}
{{ end }}
