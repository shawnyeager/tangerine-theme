/*
 * TANGERINE THEME - Main Stylesheet
 * Shared design system for shawnyeager.com and notes.shawnyeager.com
 *
 * TABLE OF CONTENTS
 * -----------------
 * _tokens.css         (separate file)  - Fonts + CSS custom properties (importable standalone)
 * 1.  RESET                            - Base styles, brand bar
 * 2.  TYPOGRAPHY                       - Heading hierarchy, body text
 * 3.  LINKS                            - Link styles, focus states, link hierarchy
 * 4.  LAYOUT                           - Container, header/footer spacing
 * 5.  FOOTER                           - Site footer, newsletter signup
 * 6.  HOMEPAGE                         - Homepage sections (bio, latest essay, podcast)
 * 7.  COMPONENTS                       - Cards, link-grid, topic tags, cta-group
 * 8.  ESSAYS                           - Essay listings, single essay pages
 * 9.  MARKDOWN                         - Reading content styles (CSS nesting)
 * 10. PAGE-SPECIFIC                    - Page layouts, pagination, contact, skip links
 * 11. UTILITIES                        - Helper classes (sr-only, hidden, etc)
 * 12. DARK MODE                        - Theme toggle & system preference overrides
 * 13. PRINT                            - Print styles
 * 14. MEDIA EMBEDS                     - YouTube, video captions
 * 15. MOBILE                           - Responsive breakpoints
 * 16. V4V PAGE                         - Value for Value payment page
 * 17. ADVISORY PAGE                    - Service tiers and credibility
 * 18. CONVERSION COMPONENTS            - Low-friction CTAs
 * 19. GHOST BUTTONS                    - Ghost button system and variants
 * 20. KEYBOARD HELP                    - Keyboard shortcuts modal
 * 21. BLOCK EASTER EGG                 - Mempool next block visualization
 *
 * Line numbers are approximate. Update when making significant structural changes.
 *
 * CASCADE LAYERS (for future refactoring):
 * @layer tokens, reset, base, components, pages, utilities, dark-mode, print;
 *
 * Note: Layer declarations are documented but not yet implemented.
 * Wrap sections in @layer blocks when splitting into partials.
 */

/* ==========================================================================
   1. RESET - Base Styles & Browser Normalization

   Note: Design tokens (_tokens.css) are concatenated by Hugo Pipes.
   See layouts/partials/head/resources.html for the build pipeline.
   ========================================================================== */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    overflow-y: scroll; /* Prevent horizontal shift when scrollbar appears/disappears */
}

body {
    font-family: var(--font-body);
    font-size: var(--font-base);
    font-weight: var(--font-weight-body);
    line-height: var(--line-height-body);
    color: var(--text-primary);
    background: var(--background-body);
    transition: background-color var(--transition-fast), color var(--transition-fast);
    letter-spacing: var(--letter-spacing-body);
}

code,
pre,
.info-pair code {
    letter-spacing: normal;
}

/* Info-pair code: fingerprints, npubs, keys - preserve line breaks, allow wrapping */
.info-pair code {
    display: inline-block;
    max-width: 100%;
    white-space: pre-line;
}

/* Brand Bar - Fixed orange strip at top of viewport
   Visual brand element, not functional navigation
   -------------------------------------------------- */

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--brand-bar-height);
    background: var(--brand-orange);
    z-index: var(--z-brand-bar);
}

/* ==========================================================================
   2. TYPOGRAPHY - Heading Hierarchy & Body Text
   ========================================================================== */

/*
 * Heading Letter-Spacing Strategy:
 * - Base: All headings use tight-md (-0.01em) for comfortable reading
 * - H1: Override to tight-lg (-0.02em) because larger text needs tighter spacing
 * - .site-title: Override to normal (0) for brand name readability
 */
h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-heading);
    letter-spacing: var(--letter-spacing-tight-md);
    color: var(--text-primary);
}

h1 {
    font-size: var(--font-custom-32);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-xl);
    letter-spacing: var(--letter-spacing-tight-lg);
}

/* Brand square in header - home link */
.home-link {
    display: flex;
    align-items: center;
    position: relative;
}

/* Touch target expansion via pseudo-element - doesn't affect layout */
.home-link::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: var(--touch-target-min);
    height: var(--touch-target-min);
}

/* Home square - solid orange (default for .com) */
.home-square {
    display: block;
    width: var(--home-square-size);
    height: var(--home-square-size);
    background-color: var(--brand-orange);
}

/* Home square - outlined (notes site) */
.home-square--outlined {
    background-color: transparent;
    border: var(--home-square-border-width) solid var(--brand-orange);
}

/* Home square - dot (share site) */
.home-square--dot {
    background-color: transparent;
    border: var(--home-square-border-width) solid var(--brand-orange);
    position: relative;
}

.home-square--dot::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 6px;
    height: 6px;
    background-color: var(--brand-orange);
    border-radius: 50%;
    transform: translate(-50%, -50%);
}

.home-link:hover .home-square {
    opacity: 0.8;
}

/* Homepage display title - large, prominent headline */
h1.display-title {
    font-size: var(--font-custom-56);
    font-weight: var(--font-weight-medium);
    line-height: var(--line-height-title);
    margin-top: 0;
    margin-bottom: var(--space-md);
    letter-spacing: var(--letter-spacing-tight-xl);
}

/* Notes homepage - more casual, smaller title */
.notes-homepage h1.display-title {
    font-size: var(--font-custom-40);  /* 40px - less prominent than 56px */
    font-weight: var(--font-weight-medium);  /* 500 */
}

@media (max-width: 600px) {
    h1.display-title {
        font-size: var(--font-custom-40);  /* 40px - more impactful hero on mobile */
    }

    .notes-homepage h1.display-title {
        font-size: var(--font-custom-32);  /* 32px on mobile - casual but prominent */
    }
}

/* Global headings - use typography tokens for tight, consistent spacing */
h2 {
    font-size: var(--font-custom-24);
    font-weight: var(--font-weight-semibold);
    margin-top: var(--heading-above-lg);
    margin-bottom: var(--heading-below-lg);
}

h3 {
    font-size: var(--font-lg);
    font-weight: var(--font-weight-semibold);
    margin-top: var(--heading-above-md);
    margin-bottom: var(--heading-below-md);
}

h4 {
    font-size: var(--font-lg);
    font-weight: var(--font-weight-semibold);
    margin-top: var(--heading-above-sm);
    margin-bottom: var(--heading-below-sm);
}

h5, h6 {
    font-size: var(--font-base);
    font-weight: var(--font-weight-semibold);
    margin-top: var(--space-lg);
    margin-bottom: var(--space-xs);
}

/* CTA + heading: let heading's natural margin provide spacing (no adjustment needed) */

p {
    margin-bottom: var(--space-md);
    color: var(--text-secondary);
    font-weight: var(--font-weight-body);
}

/* Action link spacing now controlled by shortcode classes (.action-link, .secondary-link, .back-link)
   via margin-top - see Link Hierarchy section */

ul {
    margin: var(--space-md) 0;
    padding-left: var(--space-lg);
}

li {
    margin-bottom: var(--space-xs);
    line-height: var(--line-height-body);
    color: var(--text-secondary);
    font-weight: var(--font-weight-body);
}

/* Bold text in page-body content - enhanced visibility */
.page-body strong,
.page-body b {
    font-weight: var(--font-weight-semibold);
    color: var(--text-bold);
}

/* Highlighted text (markdown ==text==) */
mark {
    background-color: var(--highlight-bg);
    color: var(--text-primary);
    padding: 0.2em 0.4em;
    border-radius: var(--border-radius-code);
}

/* ==========================================================================
   3. LINKS - Link Styles, Focus States, Link Hierarchy
   ========================================================================== */

a {
    color: var(--brand-orange);
    text-decoration: none;
    transition: color var(--transition-fast);
}

a:hover {
    color: var(--brand-orange-hover);
    text-decoration: underline;
    text-decoration-color: var(--underline-color-brand);
    text-decoration-thickness: var(--underline-thickness);
    text-underline-offset: var(--underline-offset);
}

/* Navigation links - no underline on hover (clear navigation zones) */
header a:hover,
.footer-links a:hover,
.skip-link:hover {
    text-decoration: none;
}

/* Focus Indicators - Keyboard Navigation Accessibility
   -------------------------------------------------- */

/* Remove default outline, replace with custom focus-visible styles */
a:focus {
    outline: none;
}

/* Visible focus indicators for keyboard navigation only */
a:focus-visible,
button:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible,
[tabindex]:focus-visible {
    outline: var(--focus-ring-width) solid var(--brand-orange);
    outline-offset: var(--focus-ring-offset);
    border-radius: var(--border-radius-sm);
}

/* Reduced Motion Support - Accessibility
   -------------------------------------------------- */

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    /* Skip link should still appear for accessibility */
    .skip-link:focus {
        transition: none;
    }
}

/* Link Hierarchy System - Intent-based link categories

   PRIMARY CTAs (.action-link, .back-link, .all-essays, .all-notes)
   - Orange with arrows (→ or ←), color lightens on hover
   - Display: inline-flex with gap for arrow spacing

   SECONDARY LINKS (.secondary-link)
   - Gray/secondary color, orange on hover
   - Underlined at rest, none on hover

   INLINE CONTENT LINKS (body links)
   - Orange, underline appears on hover
   ========================================================================== */

/* Shared transition for all branded links (excludes .secondary-link - it has its own underline) */
:is(.action-link, .back-link, .all-essays, .all-notes, .essay-footer a,
    .pagination-prev, .pagination-next) {
    text-decoration: none;
    transition: color var(--transition-fast);
}

/* Action Links - Primary action links WITH arrows (→)
   Usage: "Read more →", "All essays →", "Subscribe to newsletter →"
   Selector group: .cta-link-group (conceptual - these share CTA styling) */
:is(.action-link, .back-link, .all-essays, .all-notes, .essay-footer a,
    .pagination-prev, .pagination-next) {
    font-family: var(--font-heading);
    font-size: var(--font-base);
    color: var(--brand-orange);
    font-weight: var(--font-weight-medium);
    display: inline-flex;
    align-items: center;
    gap: 0;
}

/* Action links: block display for margin control */
.action-link {
    display: flex;  /* Block-level flex for margin-top to work */
    width: fit-content;
    margin-top: 0;
    margin-bottom: 0;  /* Following element's margin-top provides spacing */
}

/* Arrow spans in action links: prevent underline */
:is(.action-link, .back-link, .all-essays, .all-notes,
    .pagination-prev, .pagination-next) span[aria-hidden="true"] {
    text-decoration: none;
}

/* Arrow spacing (no space character in HTML) */
.action-link .arrow {
    margin-left: var(--arrow-spacing);
}

.back-link .arrow,
.pagination-prev .arrow {
    margin-right: var(--arrow-spacing);
}

.pagination-next .arrow {
    margin-left: var(--arrow-spacing);
}

/* Action links inside paragraphs: inline, no margins */
p .action-link {
    display: inline-flex;
    margin-top: 0;
    white-space: nowrap;
}

/* Action links inside container contexts: reset block-level properties */
.footer-links .action-link {
    display: inline-flex;
    width: auto;
    margin-top: 0;
    margin-bottom: 0;
}

/* Adjacent action links in horizontal containers: no stacking margin */
.footer-links .action-link + .action-link {
    margin-top: 0;
}

/* Hover state for all primary action links - no underline (arrows would be underlined) */
:is(.action-link, .back-link, .all-essays, .all-notes, .essay-footer a,
    .pagination-prev, .pagination-next):hover {
    color: var(--brand-orange-hover);
    text-decoration: none;
}

/* Underline link text (not arrow) on hover */
:is(.action-link, .all-essays, .all-notes, .essay-footer a,
    .pagination-prev, .pagination-next):hover .link-text {
    text-decoration: underline;
    text-decoration-color: var(--underline-color-brand);
    text-decoration-thickness: var(--underline-thickness);
    text-underline-offset: var(--underline-offset);
}

/* Secondary Links - Utility style for downloads and de-emphasized actions
   Usage: "Download contact card", "Download ASCII key"
   Gray, underlined, less prominent than action links */
.secondary-link {
    font-family: var(--font-heading);
    color: var(--text-secondary);
    font-size: var(--font-base);
    font-weight: var(--font-weight-medium);
    text-decoration: underline;
    text-decoration-color: var(--underline-color-muted);
    text-decoration-thickness: var(--underline-thickness);
    text-underline-offset: var(--underline-offset);
    transition: color var(--transition-fast);
    display: block;
    width: fit-content;
    margin-top: var(--space-sm);
}

/* Stacked action links: default spacing for utility/landing pages */
.action-link + .action-link,
.action-link + .secondary-link,
.secondary-link + .action-link,
.secondary-link + .secondary-link {
    margin-top: var(--space-md);
}

/* Freestanding action links after info blocks: breathing room */
.info-pair:has(+ .action-link, + .secondary-link, + p) {
    margin-bottom: var(--space-md);
}

/* New section after action links */
.action-link + .info-pair,
.secondary-link + .info-pair {
    margin-top: var(--space-xl);
}

/* Contact section spacing from intro text */
.contact-section {
    margin-top: var(--space-lg);
}

/* Hover states */
.secondary-link:hover {
    color: var(--brand-orange-hover);
    text-decoration: none;
}

/* ==========================================================================
   4. LAYOUT - Container, Header/Footer Spacing
   ========================================================================== */

.container {
    max-width: var(--content-max-width);
    margin: 0 auto;
    /* Top padding adds brand-bar-height to compensate for overlay */
    padding: calc(var(--space-xl) + var(--brand-bar-height)) var(--space-xl) 0;
}

/* Header & Navigation
   -------------------------------------------------- */

body > .container:first-of-type {
    padding-bottom: 0;
}

/* Header/Footer Spacing - Frame edge spacing
   Footer tight gap uses explicit padding because line-height extends ABOVE
   text, not between the HR and content.
   Tokens defined in :root section above.
   -------------------------------------------------- */

/* Page-level site header spacing (not article headers) */
body > .container > header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--header-gap-below);
}

.site-title {
    margin: 0;
    font-size: var(--font-lg);
    font-weight: var(--font-weight-semibold);
}

.site-title a {
    color: var(--text-primary);
    text-decoration: none;
}

.site-title a:hover {
    color: var(--brand-orange);
}

nav {
    font-family: var(--font-heading);
    font-size: var(--font-lg);  /* Match site-title size */
    display: flex;
    gap: var(--space-lg);
    margin-bottom: 0;
}

main .container {
    padding-top: 0;
}

/* Adaptive footer positioning for short pages
 *
 * Data sources:
 * - Statcounter: 1920×1080 (23%), 1366×768 common viewport heights
 * - Nielsen Norman: 57% viewing time above fold (~600-800px)
 *
 * Values:
 * - Floor 420px: mobile/small laptop minimum (600px viewport - 80px header - buffer)
 * - Preferred 70dvh: scales with dynamic viewport (adapts to mobile browser chrome)
 * - Ceiling 620px: keeps footer at fold line (~700px - 80px header)
 */
main {
    min-height: clamp(420px, 70dvh, 620px);
}

nav a {
    color: var(--text-secondary);
    font-weight: var(--font-weight-medium);
    text-decoration: none;
    /* Touch target via pseudo-element extending downward - text stays at top */
    position: relative;

    &:hover,
    &.active {
        color: var(--brand-orange);
    }
}

nav a::after {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    height: var(--touch-target-min);
    min-width: var(--touch-target-min);
}

/* ==========================================================================
   5. FOOTER - Site Footer & Newsletter Signup

   Unified footer zone: email signup form + site links.
   Uses frame-edge spacing (footer-gap-above/below tokens).
   ========================================================================== */

body > .container > footer {
    margin-top: var(--footer-gap-above);
    padding-top: var(--footer-gap-tight);
    padding-bottom: var(--footer-gap-below);
    /* 70% opacity: strong enough to anchor footer on short pages,
       soft enough to avoid visual heaviness (Material Design uses
       similar values for medium-emphasis elements) */
    border-top: var(--border-width) solid color-mix(in srgb, var(--border-color) 70%, transparent);
}

.email-signup-intro {
    color: var(--text-secondary);
    font-size: var(--font-base);
    line-height: var(--line-height-body);
    margin-bottom: var(--space-sm);
}

.email-form {
    display: flex;
    gap: var(--space-xs);
    align-items: stretch;
    margin-bottom: var(--space-md);  /* 16px to footer links */
    flex-wrap: nowrap;
}

.email-form input[type="email"] {
    padding: var(--space-xs) 0;  /* Compact vertical padding for inline form */
    border: none;
    border-bottom: var(--border-subtle);
    border-radius: 0;
    font-size: var(--font-sm);
    font-family: var(--font-body);
    background: var(--background-body);
    color: var(--text-primary);
    flex: 1;
    max-width: var(--skip-link-max-width);
    transition: border-color var(--transition-fast);
}

.email-form input[type="email"]:focus {
    outline: none;
    border-bottom-color: var(--brand-orange);
}

/* Show validation hint only after user has typed something */
.email-form input[type="email"]:invalid:not(:placeholder-shown) {
    border-bottom-color: var(--brand-orange);
}

.email-form input[type="email"]::placeholder {
    color: var(--text-meta);
    opacity: 0.5;
}

/* Email form button now uses .btn-ghost.btn-ghost--muted */

.footer-links {
    display: flex;
    gap: var(--space-md);
    flex-wrap: wrap;
    align-items: center;
}

.footer-links a {
    color: var(--text-meta);
    text-decoration: none;
    transition: color var(--transition-fast);
    font-size: var(--font-sm);
    font-family: var(--font-body);
    display: inline-flex;
    align-items: center;
    gap: 0;

    &:hover {
        color: var(--brand-orange-hover);
    }
}

/* Footer arrows: use Satoshi to match CTA arrows */
.footer-links a span[aria-hidden="true"] {
    font-family: var(--font-heading);
}

.footer-links a .arrow {
    margin-left: var(--arrow-spacing);
}

/* V4V icon tap target - pseudo-element creates 48x48 clickable area without affecting layout */
.footer-links a[aria-label="Value for value"] {
    position: relative;
}

/* Optical alignment - nudge SVG up to align with text x-height */
.footer-links a[aria-label="Value for value"] svg {
    vertical-align: middle;
}

.footer-links a[aria-label="Value for value"]::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: var(--touch-target-min);
    height: var(--touch-target-min);
}

/* ==========================================================================
   6. HOMEPAGE - Homepage Sections (Bio, Latest Essay, Podcast Card)

   Section spacing uses bottom-margin only (no top margins to avoid stacking).
   Sections connect to footer via margin-bottom: 0 on last section.
   ========================================================================== */

.site-intro {
    margin-bottom: calc(var(--section-gap) + var(--space-lg));
    color: var(--text-secondary);
    font-size: var(--font-lg-plus);
    line-height: var(--line-height-reading);
}

/* Accent text - brand orange */
.text-accent {
    color: var(--brand-orange);
}

/* Tagline - prominent subheadline */
.intro-tagline {
    font-family: var(--font-heading);
    font-size: var(--font-custom-24);
    font-weight: var(--font-weight-medium);
    color: var(--text-primary);
    line-height: var(--line-height-heading);
    margin-top: var(--space-sm);
    margin-bottom: var(--space-lg);
}

/* Sectors - subtle with divider line below */
.intro-sectors {
    font-family: var(--font-heading);
    font-size: var(--font-sm);
    font-weight: var(--font-weight-medium);
    color: var(--text-meta);
    letter-spacing: var(--letter-spacing-wide);
    text-transform: uppercase;
    padding-bottom: var(--space-md);
    border-bottom: var(--border-subtle);
    margin-bottom: var(--space-lg);
}

/* Intro body paragraphs */
.site-intro .intro-body {
    color: var(--text-secondary);
}

.intro-body p {
    margin-bottom: var(--space-lg);
}

.intro-body p:last-of-type {
    margin-bottom: 0;
}

/* CTA group in intro - inline buttons */
.site-intro .cta-group {
    flex-direction: row;
    align-items: baseline;
    gap: var(--space-md);
    margin-top: var(--space-lg);
}

.site-intro .action-link {
    display: block;
    margin-top: var(--space-md);
    font-size: inherit;
}

/* Homepage intro mobile adjustments */
@media (max-width: 600px) {
    /* Navigation - readable size with good tap targets */
    nav a {
        font-size: var(--font-base);
    }

    .site-intro {
        margin-bottom: var(--space-2xl);
        font-size: var(--font-base);
    }

    .intro-tagline {
        font-size: var(--font-lg);
        margin-bottom: var(--space-md);
    }

    .intro-sectors {
        font-size: var(--font-xs);
        letter-spacing: var(--letter-spacing-wide);
        padding-bottom: var(--space-sm);
        margin-bottom: var(--space-md);
    }

    .intro-body p {
        margin-bottom: var(--space-md);
    }

    .site-intro .cta-group {
        flex-direction: column;
        margin-top: var(--space-md);
    }

    .site-intro .secondary-link {
        font-size: var(--font-sm);
    }
}

/* Section Label Variants:
   - .section-label-small: Subtle dividers (--font-sm, --text-subtle)
     Use for: "Latest Essay", "Topics", "Recent Essays" headers
   - .section-label-medium: Prominent groupings (--font-base, --text-secondary)
     Use for: Year headers in essay/note lists

   Both use: Satoshi, uppercase, wide letter-spacing, medium weight */
.essay-section-header,
.section-label-small,
.topics h4 {
    font-family: var(--font-heading);
    font-size: var(--font-sm);
    font-weight: var(--font-weight-medium);
    letter-spacing: var(--letter-spacing-wide);
    text-transform: uppercase;
    color: var(--text-subtle);
    margin-bottom: var(--space-md);

    /* Override margin-top for semantic headings (h1/h2/h3) */
    &:is(h1, h2, h3) {
        margin-top: 0;
    }
}

/* Reduce spacing between section label and topic tags in topics section */
.topics .section-label-small {
    margin-bottom: var(--space-xs);  /* 8px - tight grouping with topic tags */
}

.latest-essay,
.writing-essay {
    margin-bottom: var(--section-gap);  /* 48px - gap to next section */

    /* Semantic heading: essay title (h3 under h2 section header) */
    h3 {
        font-size: var(--font-2xl);
        font-weight: var(--font-weight-medium);
        margin-top: 0;
        margin-bottom: var(--space-sm);  /* 16px - title to description */
        line-height: var(--line-height-heading);

        a {
            color: var(--text-primary);

            &:hover {
                color: var(--brand-orange);
            }
        }
    }

    p {
        margin-bottom: var(--space-sm);
        font-size: var(--font-base);
        line-height: var(--line-height-body);
    }
}

@media (max-width: 600px) {
    .latest-essay h3,
    .writing-essay h3 {
        font-size: var(--font-xl);
    }
}

/* ==========================================================================
   7. COMPONENTS - Cards, Topic Tags

   Reusable UI components: RSS card, topic tags.
   Cards share base styling (padding, background, transitions).
   ========================================================================== */



/* Content images - systematic elevation */
.page-body img {
    box-shadow: var(--shadow-content-light);
    transition: box-shadow var(--transition-fast);
}

/* Topic Tags - Browseable topic navigation
   -------------------------------------------------- */

.topics {
    margin-bottom: var(--space-lg);  /* Section gap to essay list below */
}

/* When essays directly follow topics, remove essay list margin-top */
.topics + .recent-essays {
    margin-top: 0;
}

/* Keep section-label-medium different (year headers in notes) */
.recent-notes h3,
.section-label-medium {
    font-family: var(--font-heading);
    font-size: var(--font-base);
    font-weight: var(--font-weight-medium);
    letter-spacing: var(--letter-spacing-wide);
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: var(--space-md);
    margin-top: var(--space-xl);
}

.recent-notes h3:first-child,
.section-label-medium:first-child {
    margin-top: 0;
}

.topic-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
    margin-bottom: 0;  /* Parent .topics controls spacing */

    a {
        color: var(--text-meta);
        text-decoration: none;
        font-size: var(--font-sm);
        background: var(--background-card);
        padding: var(--space-xs) var(--space-sm);
        border-radius: var(--border-radius-interactive);
        transition: background var(--transition-fast), color var(--transition-fast);

        &:hover {
            color: var(--brand-orange);
            background: color-mix(in srgb, var(--background-card) 80%, var(--brand-orange) 20%);
        }
    }
}

/* CTA Group - Wrapper for related call-to-action links
   Used by: {{< cta-group >}} shortcode on /lets-win, /pgp, etc.
   -------------------------------------------------- */
.cta-group {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-sm);
}

/* Text-link pairs need less space than button+text pairs */
.cta-group .action-link + .secondary-link {
    margin-top: 0;
}

/* CTA groups inside long-form content inherit paragraph rhythm */
:is(.essay-body, .note-body) .cta-group {
    gap: var(--para-gap-long-form);
}

/* ==========================================================================
   8. ESSAYS - Essay/Note Listings & Single Pages

   List items: date + title flex layout with baseline alignment.
   Single pages: title + meta + body structure.
   ========================================================================== */

/* Section lists have no bottom margin - footer/next section provides spacing */
.recent-essays,
.recent-notes {
    margin-bottom: 0;
}

.page-title {
    font-size: var(--font-custom-32);
    font-weight: var(--font-weight-semibold);
    line-height: var(--line-height-title);
    margin-top: 0;
    margin-bottom: var(--space-xs);  /* Tight coupling to meta/subtitle; body controls gap via margin-top */
    letter-spacing: var(--letter-spacing-tight-xl);
}

.page-subtitle {
    font-size: var(--font-lg);
    color: var(--text-secondary);
    margin-top: 0;
    margin-bottom: var(--space-lg);
}

.page-intro {
    color: var(--text-secondary);
    font-size: var(--font-base);
    line-height: var(--line-height-body);
    margin-top: var(--space-xs);
    margin-bottom: var(--space-lg);

    p {
        margin: 0;
    }
}

/* Content containers: margin-top collapses with meta/subtitle margin-bottom when present */
.page-body,
.topics,
.recent-notes {
    margin-top: var(--space-lg);
}

.essay-item,
.note-item {
    margin-bottom: var(--space-xs);
    contain: layout style paint;

    a {
        color: var(--text-primary);
        text-decoration: none;
        display: flex;
        gap: var(--space-lg);
        line-height: var(--line-height-body);
        align-items: baseline;

        &:hover {
            color: var(--brand-orange);
        }
    }
}

time.essay-date,
time.note-date,
.essay-date,
.note-date {
    color: var(--text-meta);
    font-size: var(--font-sm);
    font-weight: var(--font-weight-normal);
    font-variant-numeric: tabular-nums;
    letter-spacing: var(--letter-spacing-tight-md);
    flex-shrink: 0;
    white-space: nowrap;
}

.essay-title,
.note-title {
    flex: 1;
    font-weight: var(--font-weight-list-title);
    font-size: var(--font-base);
}

/* Full listing pages (/essays/, /notes/) - wider row spacing */
.full-list .essay-item,
.full-list .note-item {
    margin-bottom: var(--space-md);
}

/* Essay/Note items with excerpts - stacked layout */
.essay-item.has-excerpt,
.note-item.has-excerpt {
    margin-bottom: var(--space-lg);

    a {
        flex-direction: column;
        gap: 0;
        align-items: flex-start;
    }

    .essay-date,
    .note-date {
        font-size: var(--font-xs);
        margin-bottom: var(--space-label-gap);
    }

    .essay-title,
    .note-title {
        font-size: var(--font-xl);
        font-weight: var(--font-weight-medium);
    }
}

/* Recent quarter (first 3 essays) - prominent treatment */
.full-list .essay-item.has-excerpt:nth-child(-n+3),
.full-list .note-item.has-excerpt:nth-child(-n+3) {
    margin-bottom: var(--space-2xl);  /* 48px - generous spacing */

    .essay-title-link,
    .note-title-link {
        display: block;
        color: var(--text-primary);
        text-decoration: none;
        margin-bottom: var(--space-sm);  /* 12px - gap before excerpt */

        &:hover {
            color: var(--brand-orange);
        }
    }

    .essay-title,
    .note-title {
        font-size: var(--font-2xl);  /* 30px - larger for emphasis */
        font-weight: var(--font-weight-semibold);  /* 600 - bolder */
    }

    .essay-excerpt,
    .note-excerpt {
        font-size: var(--font-base);  /* 16px vs 14px - more readable */
    }
}

/* Archive (essay 4+) - compact treatment */
.full-list .essay-item.has-excerpt:nth-child(n+4),
.full-list .note-item.has-excerpt:nth-child(n+4) {
    margin-bottom: var(--space-md);  /* 16px - tighter spacing */

    .essay-title,
    .note-title {
        font-size: var(--font-lg);  /* 18px - smaller */
    }
}

/* Hero images on listing pages (first 3 essays only) */
.essay-hero-link,
.note-hero-link {
    display: block;
    margin-bottom: var(--space-sm);  /* 12px - tighter connection to title */
}

.essay-list-hero,
.note-list-hero {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;  /* Match single essay page hero images */
    display: block;
    border-radius: 0;  /* Sharp edges — matches single-page essay hero */
}

/* Dark mode: warm tint filter for list hero images */
@media (prefers-color-scheme: dark) {
    html:not([data-theme="light"]) .essay-list-hero,
    html:not([data-theme="light"]) .note-list-hero {
        filter: brightness(0.88) sepia(15%) saturate(1.1);
    }
}
html[data-theme="dark"] .essay-list-hero,
html[data-theme="dark"] .note-list-hero {
    filter: brightness(0.88) sepia(15%) saturate(1.1);
}

.essay-excerpt,
.note-excerpt {
    color: var(--text-secondary);
    font-size: var(--font-sm);
    line-height: var(--line-height-body);
    margin: var(--space-xs) 0 0 0;
}

/* Last item before CTA link doesn't need margin - CTA provides the gap */
.essay-item:last-of-type,
.note-item:last-of-type {
    margin-bottom: 0;
}

.all-essays,
.all-notes {
    margin-top: var(--space-md);  /* 16px - matches section heading spacing */
}

.topic-count {
    color: var(--text-meta);
    font-size: var(--font-sm);
    margin-bottom: var(--space-lg);  /* 24px - clear separation to essay list */
}

/* Writing stream — Rhythm Break v2 (mixed essays + notes)
   Essays: accent bar + large title + description — open, substantial
   Notes: clustered in card containers — enclosed, compact
   Topics: brand-orange discipline map
   -------------------------------------------------- */
.writing-stream {
    margin-top: var(--space-lg);
}

/* Topic navigation — brand-orange discipline map */
.writing-topics {
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    gap: var(--space-xs);
    margin-bottom: var(--space-xl);
    padding-bottom: var(--space-lg);
    border-bottom: var(--border-subtle);

    a {
        font-family: var(--font-heading);
        font-size: var(--font-sm);
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-wide);
        text-transform: uppercase;
        color: var(--text-meta);
        text-decoration: none;
        transition: color var(--transition-fast);

        &:hover {
            color: var(--brand-orange);
        }
    }

    .topic-sep {
        color: var(--text-meta);

        &:last-of-type {
            display: none;
        }
    }
}

/* Writing page — only styles that don't exist elsewhere
   Essay h3/a styles come from .latest-essay (shared rule above)
   Note styles come from .note-item/.note-title/.note-date (shared rules above)
   -------------------------------------------------- */
.writing-essay-desc {
    color: var(--text-secondary);
}

.writing-essay-meta {
    margin-top: var(--space-sm);
    font-size: var(--font-sm);
    color: var(--text-meta);
    display: flex;
    flex-wrap: wrap;
    gap: 0 var(--space-sm);
    align-items: baseline;
}

.writing-essay-readtime::before {
    content: "·";
    margin-right: var(--space-sm);
}

.writing-notes-cluster {
    margin-bottom: var(--section-gap);
}

.writing-pagination {
    margin-top: var(--space-xl);
}

/* Single Essay/Note Page
   -------------------------------------------------- */

.essay-content,
.note-content {
    max-width: var(--content-max-width);
}

.page-meta {
    margin-bottom: var(--space-xl);  /* Clear break before content begins */
    color: var(--text-meta);
    font-size: var(--font-sm);
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

.page-meta-separator {
    opacity: 0.5;
}

/* Essay/note titles - medium weight, size provides hierarchy */
.essay-title-single,
.note-title-single {
    font-size: var(--font-custom-32);
    font-weight: var(--font-weight-medium);
    line-height: var(--line-height-title);
    margin-bottom: var(--space-xs);  /* Tight coupling to metadata below */
    letter-spacing: var(--letter-spacing-tight-lg);
    text-wrap: balance;
}

/* ==========================================================================
   Essay Hero Images

   Full-width hero treatment for essay feature images.
   Refined spacing that integrates with the editorial aesthetic.
   ========================================================================== */

.essay-hero {
    margin-bottom: var(--space-xl);
}

.essay-hero-image {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
    display: block;
    color: transparent;  /* Hide alt text during load, preserves screen reader access */
}

/* Mobile: tighter spacing */
@media (max-width: 600px) {
    .essay-hero {
        margin-bottom: var(--space-lg);
    }
}

/* Dark mode hero images: subtle warm tint for brand cohesion.
   Note: mask-image removed - it blocked progressive rendering. */
@media (prefers-color-scheme: dark) {
    html:not([data-theme="light"]) .essay-hero-image {
        filter: brightness(0.88) sepia(15%) saturate(1.1);
    }
}

html[data-theme="dark"] .essay-hero-image {
    filter: brightness(0.88) sepia(15%) saturate(1.1);
}

.essay-body,
.note-body {
    font-size: var(--font-lg);
    line-height: var(--line-height-reading);

    /* Paragraphs */
    p {
        margin-bottom: var(--space-md);
        font-weight: var(--font-weight-normal);
        color: var(--text-primary);
    }

    /* Unordered lists */
    ul {
        margin: var(--space-md) 0;
        padding-left: var(--space-lg);
    }

    /* List items */
    li {
        margin-bottom: var(--space-xs);
        font-weight: var(--font-weight-normal);
        color: var(--text-primary);
    }

    /* Bold text - enhanced visibility */
    strong,
    b {
        font-weight: var(--font-weight-semibold);
        color: var(--text-bold);
    }

    /* Images - systematic elevation */
    img {
        box-shadow: var(--shadow-content-light);
        transition: box-shadow var(--transition-fast);
    }
}

/* Long-form paragraph spacing - 0.75× line box (18px × 1.45 = 26.1px line box)
   Light: 1.25rem (20px) = 0.77× line box
   Dark: 1.375rem (22px) = 0.85× line box (compensates for perceived density) */
:is(.essay-body, .note-body) p {
    margin-bottom: var(--para-gap-long-form);
}

/* Long-form stacked CTAs - match paragraph rhythm */
:is(.essay-body, .note-body) :is(
    .action-link + .action-link,
    .action-link + .secondary-link,
    .secondary-link + .action-link,
    .secondary-link + .secondary-link
) {
    margin-top: var(--para-gap-long-form);
}

/* Reading content uses primary color for optimal contrast */
.page-body p,
.latest-essay p {
    color: var(--text-primary);
}

/* First heading after page header elements - reduce top margin to avoid excessive stacking
   Applies when meta/title/subtitle elements precede the first content heading */
:is(.essay-content, .note-content) > header + :is(.essay-body, .note-body) > h2:first-child {
    margin-top: 0;  /* No top margin - header elements provide spacing */
}

/* ==========================================================================
   9. MARKDOWN - Content Body Styles (CSS Nesting)

   Styles for Markdown-generated content within .essay-body and .note-body.
   Uses CSS nesting for scoped element styling.
   Includes: lists, blockquotes, code blocks, tables, footnotes, images.
   ========================================================================== */

.essay-body,
.note-body {
    /* Ordered Lists */
    ol {
        margin: var(--space-lg) 0;
        padding-left: var(--space-lg);

        li {
            margin-bottom: var(--space-xs);
        }
    }

    /* Nested Lists */
    li > ul,
    li > ol {
        margin: var(--space-xs) 0 0 0;
    }

    /* H6 special styling */
    h6 {
        margin-top: var(--space-md);
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-wide);
    }

    /* Blockquotes */
    blockquote {
        margin: var(--space-xl) 0;
        padding: var(--space-md) var(--space-lg);
        border-left: var(--border-width-accent) solid var(--brand-orange);
        background: var(--background-card);
        font-style: italic;
        color: var(--text-secondary);

        p {
            margin-bottom: var(--space-md);

            &:last-child {
                margin-bottom: 0;
            }
        }

        /* Nested blockquotes */
        blockquote {
            margin: var(--space-md) 0;
            border-left-color: var(--text-meta);
        }
    }

    /* Inline Code */
    code {
        font-family: var(--font-monospace);
        font-size: var(--font-code-inline);
        background: var(--background-card);
        padding: 0.2em 0.4em;
        border-radius: var(--border-radius-code);
        border: var(--border-subtle);
        white-space: nowrap;
    }

    /* Code Blocks */
    pre {
        margin: var(--space-xl) 0;
        padding: var(--space-lg);
        background: var(--background-card);
        border: var(--border-subtle);
        border-radius: var(--border-radius-code);
        overflow-x: auto;
        line-height: var(--line-height-body);

        code {
            background: none;
            padding: 0;
            border: none;
            border-radius: 0;
            font-size: var(--font-code-block);
        }
    }

    /* Horizontal Rules */
    hr {
        margin: var(--space-2xl) 0;
        border: none;
        height: var(--hr-height);
        background: var(--border-color);
    }

    /* Dinkus (section break) */
    .dinkus {
        display: flex;
        justify-content: center;
        gap: var(--space-sm);
        margin: var(--space-lg) auto;
    }

    .dinkus::before,
    .dinkus::after,
    .dinkus span {
        content: '';
        width: var(--dinkus-dot-size);
        height: var(--dinkus-dot-size);
        background: color-mix(in srgb, var(--text-primary) 40%, transparent);
    }

    /* Tables */
    table {
        width: 100%;
        margin: var(--space-xl) 0;
        border-collapse: collapse;
        font-size: var(--font-base);

        th {
            padding: var(--table-cell-padding);
            text-align: left;
            font-weight: var(--font-weight-semibold);
            background: var(--background-card);
            border: var(--border-subtle);

            &:last-child {
                text-align: right;
            }
        }

        td {
            padding: var(--table-cell-padding);
            border: var(--border-subtle);

            &:last-child {
                text-align: right;
            }
        }

        tbody tr:nth-child(even) {
            background: var(--background-card);
        }
    }

    /* Task Lists */
    input[type="checkbox"] {
        margin-right: var(--space-xs);
        vertical-align: middle;
        appearance: none;
        width: var(--checkbox-size);
        height: var(--checkbox-size);
        border: var(--checkbox-border-width) solid var(--border-color);
        border-radius: var(--border-radius-code);
        background: var(--background-card);
        cursor: default;
        position: relative;
        flex-shrink: 0;

        &:checked {
            background: var(--text-meta);
            border-color: var(--text-meta);

            &::after {
                content: '✓';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: white;
                font-size: var(--font-checkbox-mark);
                font-weight: var(--font-weight-bold);
                line-height: var(--line-height-none);
            }
        }
    }

    li:has(input[type="checkbox"]) {
        list-style: none;

        &::marker {
            content: '';
        }

        input[type="checkbox"] {
            margin-left: calc(-1 * var(--checkbox-indent));
            margin-right: var(--space-sm);
        }
    }

    /* Definition Lists */
    dl {
        margin: var(--space-lg) 0;
    }

    dt {
        font-weight: var(--font-weight-semibold);
        margin-top: var(--space-md);

        &:first-child {
            margin-top: 0;
        }
    }

    dd {
        margin-left: var(--space-xl);
        margin-top: var(--space-xs);
        color: var(--text-secondary);
    }

    /* Footnotes */
    .footnotes {
        margin-top: var(--space-lg);
        margin-bottom: 0;  /* hr + li margins provide separation; avoid double-spacing before footer CTA */
        font-size: var(--font-sm);

        hr {
            margin: var(--space-lg) 0 var(--space-md) 0;
            opacity: var(--opacity-subtle);
        }

        ol {
            padding-left: var(--space-lg);
        }

        li {
            margin-bottom: var(--space-md);
            line-height: var(--line-height-body);
            color: var(--text-meta);
        }

        p {
            margin-bottom: var(--space-xs);
            color: var(--text-meta);
        }

        /* Subdued inline links - blend with footnote text, underline for affordance */
        /* Excludes backref arrows which keep their original orange styling */
        a:not(.footnote-backref) {
            color: var(--text-meta);
            text-decoration: underline;
            text-decoration-color: var(--underline-color-muted);
            text-decoration-thickness: var(--underline-thickness);
            text-underline-offset: var(--underline-offset);

            &:hover {
                color: var(--brand-orange-hover);
                text-decoration-color: var(--underline-color-brand);
            }
        }
    }

    /* Footnote back-references - subtle return arrows */
    .footnote-backref {
        margin-left: var(--space-xs);
        font-size: var(--font-base);
        opacity: var(--opacity-medium);
    }

    .footnote-backref:hover {
        opacity: 1;
        text-decoration: none;
    }

    /* Images */
    img {
        max-width: 100%;
        height: auto;
        margin: var(--space-xl) 0;
        display: block;
    }

    /* Strikethrough */
    del {
        color: var(--text-meta);
        text-decoration: line-through;
    }

    /* Superscript & Subscript */
    sup,
    sub {
        font-size: var(--font-sub-sup);
        line-height: 0;
        position: relative;
        vertical-align: baseline;
    }

    sup {
        top: -0.5em;
    }

    sub {
        bottom: -0.25em;
    }

    /* Emphasis */
    em {
        font-style: italic;
    }
}

/* Aside - acknowledgments after essay/note body */
:is(.essay-content, .note-content) .aside {
    color: var(--text-meta);
    font-style: italic;
    font-size: var(--font-base);
    margin-top: 0;  /* Preceding paragraph's margin-bottom provides spacing */
    margin-bottom: var(--para-gap-long-form);  /* Match paragraph rhythm */

    a {
        color: var(--text-meta);
        text-decoration: underline;
        text-decoration-color: var(--underline-color-muted);
        text-decoration-thickness: var(--underline-thickness);
        text-underline-offset: var(--underline-offset);

        &:hover {
            color: var(--brand-orange-hover);
            text-decoration-color: var(--underline-color-brand);
        }
    }
}

/* Back Links - Navigation links for returning to parent context
   Usage: "← All essays", "← Home", "← Back to essay"
   Meta color, Satoshi font, left arrow */
.back-link,
a.back-link {
    font-family: var(--font-heading);
    font-size: var(--font-base);
    font-weight: var(--font-weight-medium);
    color: var(--text-meta);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0;
}

.back-link:hover,
a.back-link:hover {
    color: var(--brand-orange);
    text-decoration: none;
}

/* Back arrows (←): lift to baseline (Satoshi ← yMin is -76/1000em) */
.back-link span[aria-hidden="true"],
.pagination-prev span[aria-hidden="true"] {
    font-family: var(--font-heading);
    display: inline-block;
    transform: translateY(var(--optical-arrow-lift));
}

/* ==========================================================================
   Content Navigation - End-of-content link container
   Usage: V4V link + back link, or back link alone

   Spacing rationale:
   - Default margin-top: lg (24px) — for single-link pages (404, gone)
   - With action link: margin-top: 0 — last paragraph's margin provides spacing
   - Gap matches long-form paragraph rhythm for visual consistency
   ========================================================================== */

.content-nav {
    margin-top: var(--space-lg);
    display: flex;
    flex-direction: column;
    gap: var(--para-gap-long-form);
}

/* When content-nav has action link (e.g., essays with Zap + back link)
   Zero margin - last paragraph's margin-bottom provides spacing and flexes with light/dark */
.content-nav:has(.action-link) {
    margin-top: 0;
}

/* Remove touch target from content-nav links so spacing matches paragraph rhythm */
.content-nav a {
    min-height: auto;
}

/* ==========================================================================
   10. PAGE-SPECIFIC - Page Layouts, Pagination, Contact, Skip Links

   Page-specific styling: /media bio boxes, /podcast images, pagination,
   contact display patterns, and skip link accessibility.
   ========================================================================== */

/* Bio boxes on /media page */
.bio-text {
    background: var(--background-card);
    padding: var(--space-lg);
    color: var(--text-primary);
    margin-bottom: var(--space-lg);
    line-height: var(--line-height-body);
    font-size: var(--font-base);
}

.bio-text p:last-child {
    margin-bottom: 0;
}

.bio-text .info-pair:last-child {
    margin-bottom: 0;
}

/* Page Content Wrappers
   -------------------------------------------------- */

.page-content {
    max-width: var(--content-max-width);
}

/* Page body - HR and CTA closing section */
.page-body hr {
    margin: var(--space-xl) 0 var(--space-lg) 0;
    border: none;
    height: var(--hr-height);
    background: var(--border-color);
}

.page-body hr + p {
    margin-bottom: var(--space-md);
}

.page-body .btn-primary {
    margin-bottom: var(--space-lg);
}

.page-body .btn-primary:last-child {
    margin-bottom: 0;
}

/* Image size utility - used via {{< image variant="img-lg" >}} shortcode
   !important overrides Hugo's inline width/height from image processing */
.img-lg {
    display: block;
    width: var(--image-size-lg) !important;
    height: var(--image-size-lg) !important;
    margin-bottom: var(--space-lg);
    object-fit: cover;
    border-radius: var(--border-radius-interactive);
}

/* Pagination
   -------------------------------------------------- */

.pagination {
    margin-top: var(--space-lg);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-md);
}

/* Pagination styles consolidated with CTA links above */

/* Contact Display Patterns - Utility pages (.info-pair, .info-label, .info-value)
   -------------------------------------------------- */

.info-pair {
    margin-bottom: var(--space-lg);
    display: flex;
    flex-direction: column;
    gap: var(--space-label-gap);

    /* Monospace code elements for fingerprints and keys - plain text, not links */
    code {
        font-family: var(--font-monospace);
        font-size: 0.9em;
        color: var(--text-primary);
        cursor: text;
    }
}

/* Media page contact section - tighter grouping for multiple contact methods */
#contact + .info-pair {
    margin-bottom: var(--space-lg);

    ~ .info-pair {
        margin-bottom: var(--space-lg);
    }
}

.info-label {
    font-weight: var(--font-weight-normal);
    color: var(--text-meta);
    font-size: var(--font-sm);
}

.info-value {
    color: var(--brand-orange);
    text-decoration: none;
    font-size: var(--font-base);
    transition: color var(--transition-fast);

    &:hover {
        color: var(--brand-orange-hover);
        text-decoration: underline;
        text-decoration-color: var(--underline-color-brand);
        text-decoration-thickness: var(--underline-thickness);
        text-underline-offset: var(--underline-offset);
    }
}

/* Skip Links - Keyboard navigation accessibility
   -------------------------------------------------- */

.skip-link {
    position: fixed;
    top: 0;
    left: 0;
    background: var(--brand-orange);
    color: var(--text-on-brand);
    padding: var(--space-xs) var(--space-md);
    text-decoration: none;
    z-index: var(--z-skip-link);
    font-weight: var(--font-weight-medium);
    border-radius: 0 0 var(--border-radius-interactive) 0;
    transform: translateY(-100%);
    transition: transform var(--transition-fast);
}

.skip-link:focus {
    transform: translateY(0);
}

/* ==========================================================================
   11. UTILITIES - Helper Classes

   Utility classes: screen-reader only, etc.
   ========================================================================== */

.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
}

.hidden {
    display: none;
}

/* ==========================================================================
   12. DARK MODE - Theme Toggle & System Preference Overrides

   Dark mode applies in two scenarios:
   1. System prefers dark AND user hasn't forced light mode
   2. User explicitly toggled to dark mode (regardless of system)

   ARCHITECTURE NOTE:
   CSS cannot combine @media queries with non-media selectors, so dark mode
   rules that need both system preference AND manual toggle support must be
   written twice. This is an inherent CSS limitation.

   Pattern used:
   @media (prefers-color-scheme: dark) {
       html:not([data-theme="light"]) { ... }  // System dark
   }
   html[data-theme="dark"] { ... }  // Manual toggle

   The light-dark() function (used in tokens) handles both cases automatically.
   The duplication below is for non-token values like font-weight adjustments.
   ========================================================================== */

/* Base font-weight: light mode default (400) */
:is(.essay-body, .note-body, .page-body) :is(p, li),
.latest-essay p {
    font-weight: var(--font-weight-normal);
}

/* Dark mode paragraph spacing - applies to both system dark and explicit toggle */
@media (prefers-color-scheme: dark) {
    html:not([data-theme="light"]) {
        --para-gap-long-form: 1.375rem;
    }
}
html[data-theme="dark"] {
    --para-gap-long-form: 1.375rem;
}

/* Dark mode heading colors - only needed for system preference (toggle uses light-dark()) */
@media (prefers-color-scheme: dark) {
    h2 { color: var(--text-heading-h2); }
    h3 { color: var(--text-heading-h3); }
    h4 { color: var(--text-heading-h4); }
    h5, h6 { color: var(--text-heading-h5); }

    h1, .page-title, h2, h3, h4, h5, h6,
    .essay-title-single, .note-title-single {
        font-weight: var(--font-weight-semibold);
    }

    :is(.essay-body, .note-body, .page-body) :is(strong, b) {
        font-weight: var(--font-weight-semibold);
    }

}

/* Dark mode typography - combined selector for system dark + explicit toggle
   Uses :is() to avoid repeating declarations for both scenarios */
@media (prefers-color-scheme: dark) {
    html:not([data-theme="light"]) :is(p, li) {
        font-weight: var(--font-weight-normal);
    }

    html:not([data-theme="light"]) :is(.essay-title, .note-title) {
        font-weight: var(--font-weight-light);
    }

    html:not([data-theme="light"]) :is(.essay-body, .note-body, .page-body) :is(p, li),
    html:not([data-theme="light"]) .latest-essay p {
        font-weight: var(--font-weight-light);
    }
}

/* Explicit dark toggle - for users who toggle dark when system is light */
html[data-theme="dark"] :is(p, li) {
    font-weight: var(--font-weight-normal);
}

html[data-theme="dark"] :is(.essay-title, .note-title) {
    font-weight: var(--font-weight-light);
}

html[data-theme="dark"] :is(.essay-body, .note-body, .page-body) :is(p, li),
html[data-theme="dark"] .latest-essay p {
    font-weight: var(--font-weight-light);
}


/* ==========================================================================
   13. PRINT - Print Stylesheet

   Minimal print styles: hide chrome, clean typography.
   ========================================================================== */

@media print {
    /* Hide non-content elements */
    body::before, nav, footer, .topic-tags,
    .skip-link, .keyboard-help-overlay, .copy-btn {
        display: none !important;
    }

    /* Reset colors for print */
    body {
        background: white;
        color: black;
    }

    /* Links: underline and show URL */
    a {
        color: black;
        text-decoration: underline;
    }
    a[href^="http"]::after {
        content: " (" attr(href) ")";
        font-size: 0.8em;
        color: var(--text-meta);
    }
    /* Don't show URL for internal links */
    a[href^="/"]::after,
    a[href^="#"]::after {
        content: none;
    }

    /* Page break control */
    h1, h2, h3 { page-break-after: avoid; }
    p, li { orphans: 2; widows: 2; }
    img { max-width: 100%; page-break-inside: avoid; }
    pre, blockquote { page-break-inside: avoid; }
}

/* ==========================================================================
   14. MEDIA EMBEDS - YouTube, Video Captions

   Responsive video embeds (16:9 aspect ratio) and privacy-respecting
   preview thumbnails with play button overlay.
   ========================================================================== */

/* Add extra spacing after "Recent speaking" heading */
#recent-speaking {
    margin-bottom: var(--space-lg);
}

/* Add spacing after YouTube embeds (standard iframe version) */
div[style*="padding-bottom: 56.25%"] {
    margin-bottom: var(--space-xl);
}

/* YouTube preview shortcode styles */
.youtube-preview-container {
    margin-bottom: var(--space-xl);
    position: relative;
    padding-bottom: var(--video-aspect-ratio);  /* 16:9 aspect ratio */
    height: 0;
    overflow: hidden;
    cursor: pointer;

    img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
    }
}

.play-button-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: var(--play-button-size);
    height: var(--play-button-size);
    background: var(--brand-orange);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;

    svg {
        margin-left: var(--icon-optical-adjust);
    }
}

/* Style paragraphs that follow YouTube embeds as captions */
div[style*="padding-bottom: 56.25%"] + p,
.youtube-preview-container + p {
    font-size: var(--font-sm);
    color: var(--text-secondary);
    margin-top: var(--video-caption-pull);  /* Pull caption closer to video */
    margin-bottom: var(--space-xl);
}

/* Strong text within captions (event/panel titles) */
div[style*="padding-bottom: 56.25%"] + p strong,
.youtube-preview-container + p strong {
    font-weight: var(--font-weight-semibold);
    font-style: normal;
    color: var(--text-primary);
}

/* ==========================================================================
   15. MOBILE - Responsive Breakpoints

   Mobile-first adjustments for screens < 600px.
   Note: Breakpoint is hardcoded because CSS variables don't work in media queries.
   ========================================================================== */

@media (max-width: 600px) {
    html { font-size: 16px; }

    .container { padding: calc(var(--container-mobile-h-padding) + var(--brand-bar-height)) var(--container-mobile-h-padding) 0; }
    /* Keep header row layout, just tighten nav gap */
    nav { gap: var(--space-md); }
    .email-form input[type="email"] { max-width: none; }

    /* Homepage: show 5 items on mobile (hide 6+) */
    .recent-notes:not(.full-list) .note-item:nth-of-type(n+6),
    .recent-essays:not(.full-list) .essay-item:nth-of-type(n+6) {
        display: none;
    }

    /* More generous spacing for note/essay lists on mobile - including last item */
    .note-item,
    .essay-item,
    .note-item:last-of-type,
    .essay-item:last-of-type {
        margin-bottom: var(--space-md);
    }

    /* Section header spacing - match inter-item spacing */
    .section-label-small {
        margin-bottom: var(--space-md);
    }

    /* CTA has no extra margin - last visible item's margin provides the gap */
    .all-essays,
    .all-notes {
        margin-top: 0;
    }

    /* Larger touch targets for footer links (48px minimum per Lighthouse)
       Uses padding to expand tap area + negative margin to preserve visual spacing */
    .footer-links {
        margin-top: calc(-1 * var(--footer-touch-compensation));  /* Compensate for taller tap targets */
    }
    .footer-links a {
        padding: var(--space-sm) var(--space-md);
        margin: calc(-1 * var(--space-sm)) calc(-1 * var(--space-md));
        min-height: var(--touch-target-min);
        display: inline-flex;
        align-items: center;
    }
    /* V4V icon needs square tap target */
    .footer-links a[aria-label="Value for value"] {
        padding: var(--space-md);
        margin: calc(-1 * var(--space-md));
        min-width: var(--touch-target-min);
        justify-content: center;
    }
    .footer-links a[aria-label="Value for value"]::after {
        display: none;
    }
    .pagination { flex-direction: column; align-items: flex-start; }
    .info-pair code {
        white-space: pre-line;     /* Preserve newlines, wrap at spaces (fingerprints) */
        overflow-wrap: break-word; /* Break long words if needed (npubs, keys) */
    }
}

/* Desktop: consistent list spacing for both sites */
@media (min-width: 601px) {
    .note-item,
    .essay-item {
        margin-bottom: var(--space-md);
    }
}

/* ==========================================================================
   16. V4V PAGE - Value for Value Payment Page

   Bitcoin Lightning payment page with amount selection, QR generation,
   and payment status tracking.
   ========================================================================== */

.v4v-page {
    max-width: var(--content-max-width);
    margin: 0 auto;
}

.v4v-content {
    margin-top: var(--space-md);
}

.v4v-intro {
    font-size: var(--font-lg);
    color: var(--text-secondary);
    margin-bottom: var(--space-xl);
    line-height: var(--line-height-body);
}

#share-essay {
    color: var(--brand-orange);
    text-decoration: none;
    cursor: pointer;
}

#share-essay:hover {
    text-decoration: underline;
}

.amount-selection {
    margin-bottom: var(--space-xl);
}

.amount-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
    margin-bottom: var(--space-md);
}

.amount-btn {
    padding: var(--space-lg);
    background: transparent;
    border: var(--border-width-emphasis) solid var(--border-color);
    border-radius: var(--border-radius-interactive);
    cursor: pointer;
    font-family: var(--font-system);
    font-size: var(--font-xl);
    font-weight: var(--font-weight-semibold);
    font-variant-numeric: tabular-nums;
    color: var(--text-primary);
    transition: border-color var(--transition-fast), color var(--transition-fast);
}

.amount-btn:hover {
    border-color: var(--brand-orange);
    color: var(--brand-orange);
}

.amount-btn:active {
    transform: translateY(1px);
}

.amount-btn--suggested {
    border-color: var(--brand-orange);
    color: var(--brand-orange);
}

.amount-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

.amount-btn:disabled:hover {
    border-color: var(--border-color);
    color: var(--text-primary);
}

.amount-btn--suggested:disabled {
    border-color: var(--brand-orange);
    color: var(--brand-orange);
}

.custom-amount-label {
    display: block;
    font-size: var(--font-sm);
    color: var(--text-meta);
    margin-bottom: var(--space-sm);
    font-weight: var(--font-weight-normal);
}

.custom-amount-field {
    display: flex;
    gap: var(--space-sm);
    align-items: stretch;
}

.custom-amount-input {
    padding: var(--space-xs) 0;
    border: none;
    border-bottom: var(--border-width) solid var(--border-color);
    border-radius: 0;
    font-family: var(--font-system);
    font-size: var(--font-base);
    background: var(--background-body);
    color: var(--text-primary);
    width: calc((100% - 3 * var(--space-sm)) / 4);
    text-align: right;
    transition: border-color var(--transition-fast);
}

.custom-amount-input:focus {
    outline: none;
    border-bottom-color: var(--brand-orange);
}

.custom-amount-input::placeholder {
    color: var(--text-meta);
    opacity: 0.5;
}

/* Note: .custom-amount-btn base styles consolidated in Button System section */

.custom-amount-btn:active {
    transform: translateY(1px);
}

.custom-amount-input:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

.custom-amount-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

.custom-amount-btn:disabled:hover {
    border-color: var(--text-meta);
    color: var(--text-meta);
}

.validation-error {
    color: var(--brand-orange);
    font-size: var(--font-sm);
    margin-top: var(--space-sm);
    margin-bottom: 0;
}

.error-display {
    text-align: center;
    padding: var(--space-xl);
    background: var(--background-card);
    border-radius: var(--border-radius-md);
    margin-bottom: var(--space-xl);
    animation: v4v-fadeIn var(--transition-base) ease-out;
}

.error-display .error-message {
    color: var(--brand-orange);
    font-size: var(--font-base);
    margin-bottom: var(--space-lg);
}

/* Note: .error-dismiss-btn base styles consolidated in Button System section */

.qr-display {
    text-align: center;
    padding: var(--space-xl);
    background: var(--background-card);
    border-radius: var(--border-radius-md);
    margin-bottom: var(--space-xl);
    transition: background-color var(--transition-fast);
    animation: v4v-fadeIn var(--transition-base) ease-out;
    position: relative;
}

@keyframes v4v-fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.qr-code {
    width: var(--qr-size);
    height: var(--qr-size);
    margin: 0 auto var(--space-lg);
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Center loading text in full card during loading state */
.qr-display:has(.qr-details--pending) .qr-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* Details always rendered, invisible until QR ready */
.qr-details--pending {
    visibility: hidden;
    opacity: 0;
}

.qr-details:not(.qr-details--pending) {
    animation: v4v-slideIn var(--transition-base) ease-out;
}

@keyframes v4v-slideIn {
    from {
        opacity: 0;
        transform: translateY(var(--space-sm));
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.qr-loading {
    color: var(--text-meta);
    font-size: var(--font-base);
    margin: 0;
    text-decoration: none;
}

.qr-loading.polling {
    animation: v4v-pulse 2s ease-in-out infinite;
}

@keyframes v4v-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.polling-status {
    font-size: var(--font-sm);
    color: var(--text-meta);
    margin-bottom: var(--space-md);
    animation: v4v-pulse 2s ease-in-out infinite;
}

.qr-code canvas {
    display: block;
    margin: 0 auto;
    box-shadow: var(--shadow-content-light);
    transition: box-shadow var(--transition-fast);
}

a.qr-link,
a.qr-link:hover {
    cursor: pointer;
    text-decoration: none;
}

.qr-link:hover .qr-code canvas {
    box-shadow: 0 0 0 3px var(--brand-orange);
}

.qr-hint {
    font-size: var(--font-sm);
    color: var(--text-meta);
    margin-bottom: var(--space-md);
}

.qr-hint--mobile {
    display: inline;
}

.qr-hint--desktop {
    display: none;
}

@media (min-width: 768px) {
    .qr-hint--mobile {
        display: none;
    }
    .qr-hint--desktop {
        display: inline;
    }
}

.qr-amount {
    font-size: var(--font-2xl);
    font-weight: var(--font-weight-bold);
    color: var(--text-primary);
    margin-bottom: var(--space-xs);
    letter-spacing: var(--letter-spacing-tight-md);
}

.qr-amount-value {
    font-variant-numeric: tabular-nums;
}

.qr-copy-link {
    background: none;
    border: none;
    color: var(--text-meta);
    cursor: pointer;
    font-family: inherit;
    font-size: inherit;
    font-weight: var(--font-weight-normal);
    text-decoration: underline;
    padding: 0;
    transition: color var(--transition-fast);
}

.qr-copy-link:hover {
    color: var(--brand-orange);
}

/* Note: .qr-cancel-btn base styles consolidated in Button System section */

.payment-status {
    text-align: center;
    padding: var(--space-2xl);
    background: var(--background-card);
    margin-bottom: var(--space-xl);
    transition: background-color var(--transition-fast);
}

.payment-check {
    font-size: var(--font-2xl);
    font-weight: var(--font-weight-semibold);
    color: var(--brand-orange);
    margin-bottom: var(--space-sm);
    letter-spacing: var(--letter-spacing-tight-md);
}

.payment-thanks {
    color: var(--text-secondary);
    font-size: var(--font-base);
    margin-bottom: 0;
}

.v4v-details {
    margin-top: var(--space-lg);
}

.v4v-details summary {
    cursor: pointer;
    font-size: var(--font-base);
    color: var(--text-meta);
    font-weight: var(--font-weight-medium);
    transition: color var(--transition-fast);
    list-style-position: outside;
    list-style: none;
}

.v4v-details summary::marker {
    display: none;
}

.v4v-details summary:hover {
    color: var(--brand-orange);
}

.v4v-details p {
    margin-top: var(--space-md);
    font-size: var(--font-base);
    color: var(--text-secondary);
    line-height: var(--line-height-body);
}


/* V4V mobile adjustments */
@media (max-width: 600px) {
    .custom-amount-input {
        max-width: none;
    }

    .qr-display,
    .payment-status {
        padding: var(--space-xl);
    }
}

/* ==========================================================================
   17. ADVISORY PAGE - Service tiers and credibility
   ========================================================================== */

/* Service Tiers Grid */
.service-tiers {
    display: grid;
    gap: var(--space-lg);
    margin: var(--space-xl) 0;
}

/* Individual Service Tier - Accordion */
.service-tier {
    background: var(--background-card);
    border-left: var(--border-width-accent) solid var(--brand-orange);
}

.service-tier__header {
    display: flex;
    align-items: baseline;
    gap: var(--space-md);
    padding: var(--space-lg);
    cursor: pointer;
    list-style: none;
}

.service-tier__header::-webkit-details-marker {
    display: none;
}

.service-tier__header::after {
    content: '+';
    font-size: var(--font-base);
    color: var(--text-meta);
    margin-left: auto;
}

.service-tier[open] .service-tier__header::after {
    content: '−';
}

.service-tier__name {
    font-family: var(--font-heading);
    font-size: var(--font-lg);
    font-weight: var(--font-weight-medium);
    color: var(--text-primary);
    flex: 0 0 13rem;  /* Fixed width so descriptions align across rows */
}

.service-tier__price-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-top: var(--border-subtle);
}

.service-tier__anchor {
    opacity: 0;
    color: var(--text-meta);
    text-decoration: none;
    font-weight: var(--font-weight-normal);
    padding: var(--space-md) var(--space-lg);
    transition: opacity 0.15s ease;
}

.service-tier__price-row:hover .service-tier__anchor {
    opacity: 1;
}

.service-tier__anchor:hover {
    color: var(--brand-orange);
}

@media (hover: none) {
    .service-tier__anchor {
        opacity: 1;
    }
}

.service-tier__summary {
    font-size: var(--font-base);
    color: var(--text-meta);
}

.service-tier__price {
    font-family: var(--font-heading);
    font-size: var(--font-lg);
    font-weight: var(--font-weight-medium);
    color: var(--brand-orange);
    padding: var(--space-md) var(--space-lg);
    margin: 0;
}

.service-tier__details {
    padding: 0 var(--space-lg);
    color: var(--text-secondary);
    font-size: var(--font-base);
    line-height: var(--line-height-body);
}

.service-tier__details p {
    margin: 0 0 var(--space-md) 0;
}

.service-tier__details p:last-child {
    margin-bottom: 0;
}

.service-tier__details ul {
    margin: 0 0 var(--space-md) 0;
    padding-left: var(--space-lg);
}

.service-tier__details li {
    margin-bottom: var(--space-xs);
}

.service-tier__fit {
    font-size: var(--font-sm);
    color: var(--text-meta);
    font-style: italic;
    margin: var(--space-lg) 0 0 0;
    padding: var(--space-md) var(--space-lg) var(--space-lg) var(--space-lg);
    border-top: var(--border-subtle);
}

/* Service tier mobile: stack header vertically */
@media (max-width: 600px) {
    .service-tiers {
        gap: var(--space-md);
    }

    .service-tier__header {
        position: relative;
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-xs);
        padding-right: var(--space-2xl);
    }

    .service-tier__header::after {
        position: absolute;
        top: var(--space-lg);
        right: var(--space-lg);
        margin-left: 0;
    }

    .service-tier__name {
        font-size: var(--font-base);
        flex: 0 0 auto;  /* Reset fixed width for stacked layout */
    }

    .service-tier__summary {
        font-size: var(--font-sm);
    }

    .service-tier__price {
        font-size: var(--font-base);
        padding: var(--space-sm) var(--space-md) 0 var(--space-md);
    }

    .service-tier__details {
        padding: 0 var(--space-md);
        font-size: var(--font-sm);
    }

    .service-tier__fit {
        padding: var(--space-sm) var(--space-md) var(--space-md) var(--space-md);
    }
}

/* Headshot - floated avatar for bio sections */
.headshot {
    width: var(--avatar-size-lg);
    height: var(--avatar-size-lg);
    object-fit: cover;
    float: right;
    margin-left: var(--space-lg);
    margin-bottom: var(--space-sm);
    border-radius: var(--border-radius-interactive);
}

@media (max-width: 600px) {
    .headshot {
        width: var(--avatar-size-lg-mobile);
        height: var(--avatar-size-lg-mobile);
        margin-left: var(--space-md);
    }
}

/* Section headers for advisory page */
.advisory-section-label {
    font-family: var(--font-heading);
    font-size: var(--font-sm);
    font-weight: var(--font-weight-medium);
    color: var(--text-meta);
    letter-spacing: var(--letter-spacing-wide);
    text-transform: uppercase;
    margin: var(--space-2xl) 0 var(--space-lg) 0;
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.advisory-section-label::before {
    content: '';
    width: 1.5rem;
    height: var(--border-width-emphasis);
    background: var(--brand-orange);
}

.advisory-section-label:first-child {
    margin-top: 0;
}

/* Testimonials */
.testimonial {
    overflow: hidden;
    margin: var(--space-xl) 0;
    padding: 0;
    border: none;
    border-left: var(--border-width-accent) solid var(--brand-orange);
    padding-left: var(--space-lg);
}

.testimonial__quote {
    font-size: var(--font-base);
    color: var(--text-secondary);
    line-height: var(--line-height-body);
    margin: 0 0 var(--space-sm) 0;
}

.testimonial__attribution {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.testimonial__avatar {
    float: right;
    width: var(--avatar-size-sm);
    height: var(--avatar-size-sm);
    margin: 0 0 var(--space-xs) var(--space-md);
    border-radius: var(--border-radius-interactive);
    object-fit: cover;
    filter: grayscale(1);
}

.testimonial__person {
    display: flex;
    flex-direction: column;
    gap: 0;
}

.testimonial__name {
    font-family: var(--font-heading);
    font-weight: var(--font-weight-medium);
    color: var(--text-primary);
    font-size: var(--font-sm);
}

.testimonial__title {
    color: var(--text-meta);
    font-size: var(--font-sm);
}

/* ==========================================================================
   18. CONVERSION COMPONENTS - Low-friction CTAs

   - diagnostic-cta: Low-commitment entry point
   - what-to-expect: Plain numbered steps
   ========================================================================== */

/* Diagnostic CTA - Low-friction entry point */
.diagnostic-cta {
    margin: var(--space-xl) 0;
    padding: var(--space-md) var(--space-lg);
    background: var(--background-main);
    border: var(--border-width) solid var(--border-color);
    font-size: var(--font-base);
    color: var(--text-secondary);
    text-wrap: pretty;
}

.diagnostic-cta p {
    margin: 0;
}

.diagnostic-cta a {
    color: var(--brand-orange);
    font-weight: var(--font-weight-medium);
    text-decoration: none;
    border-bottom: var(--border-width) solid transparent;
    transition: border-color var(--transition-fast);
}

.diagnostic-cta a:hover {
    border-bottom-color: var(--brand-orange);
}

/* What to Expect - plain numbered list */
.what-to-expect {
    margin: var(--space-md) 0;
}

.what-to-expect ol {
    margin: 0;
    padding-left: var(--space-lg);
    color: var(--text-secondary);
    font-size: var(--font-sm);
}

.what-to-expect li {
    margin-bottom: var(--space-xs);
    line-height: var(--line-height-body);
}

@media (max-width: 600px) {
    .diagnostic-cta {
        padding: var(--space-sm) var(--space-md);
    }
}

/* ==========================================================================
   19. GHOST BUTTONS - Shared base and variants

   Ghost buttons: transparent background with border.
   Variants: muted (newsletter) and primary (conversion CTA).
   ========================================================================== */

/* ==========================================================================
   Button System - Ghost buttons with variants

   Base: .btn-ghost - transparent background with border
   Variants:
   - --muted: gray border/text, for subtle actions (newsletter, dismiss)
   - --primary: orange border/text, for conversion CTAs
   - --sm: small size (font-sm, compact padding)
   - --lg: large size (font-xl, spacious padding)
   ========================================================================== */

/* Shared base */
.btn-ghost,
.custom-amount-btn,
.error-dismiss-btn,
.qr-cancel-btn {
    display: inline-block;
    background: transparent;
    border: var(--border-width) solid;
    cursor: pointer;
    transition: border-color var(--transition-fast), color var(--transition-fast);
    text-decoration: none;
}

/* Ghost base defaults */
.btn-ghost {
    font-family: var(--font-heading);
    border-radius: 0;
}

/* Filled primary button - high visibility CTA */
.btn-primary {
    display: inline-block;
    font-family: var(--font-heading);
    font-size: var(--font-base);
    font-weight: var(--font-weight-medium);
    padding: var(--space-sm) var(--space-lg);
    background: var(--brand-orange);
    color: var(--text-on-brand);
    border: none;
    text-decoration: none;
    cursor: pointer;
    transition: background var(--transition-fast);
}

.btn-primary:hover {
    background: var(--brand-orange-hover);
    color: var(--text-on-brand);  /* Override link hover color */
    text-decoration: none;        /* Override link hover underline */
}

.btn-primary::after {
    content: ' →';
}

/* System font buttons (V4V page) */
.custom-amount-btn,
.error-dismiss-btn,
.qr-cancel-btn {
    font-family: var(--font-system);
    font-size: var(--font-sm);
    font-weight: var(--font-weight-medium);
    padding: var(--space-xs) var(--space-md);
    border-radius: var(--border-radius-interactive);
    color: var(--text-meta);
    border-color: var(--text-meta);
}

.custom-amount-btn {
    white-space: nowrap;
    flex-shrink: 0;
}

/* Shared hover for muted buttons */
.btn-ghost--muted:hover,
.custom-amount-btn:hover,
.error-dismiss-btn:hover,
.qr-cancel-btn:hover {
    color: var(--brand-orange);
    border-color: var(--brand-orange);
}

/* Muted variant (newsletter signup) */
.btn-ghost--muted {
    padding: var(--space-xs) var(--space-md);
    font-family: inherit;
    font-size: var(--font-xs);
    font-weight: var(--font-weight-medium);
    color: var(--text-meta);
    border-color: var(--text-meta);
    border-radius: var(--border-radius-sm);
    white-space: nowrap;
    flex-shrink: 0;
}

/* Primary variant (conversion CTA) */
.btn-ghost--primary {
    padding: var(--space-sm) var(--space-lg);
    font-size: var(--font-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--brand-orange);
    border-color: var(--brand-orange);
}

.btn-ghost--primary:hover {
    color: var(--brand-orange-hover);
    border-color: var(--brand-orange-hover);
    box-shadow: inset 0 0 0 1px var(--brand-orange-hover);
    text-decoration: none;
}

.btn-ghost--primary .arrow {
    margin-left: var(--arrow-spacing);
}

/* CTA buttons mobile - reduce height */
@media (max-width: 600px) {
    .btn-primary,
    .btn-ghost--primary {
        padding: var(--space-sm) var(--space-lg);
        font-size: var(--font-base);
    }
}

/* ==========================================================================
   20. KEYBOARD HELP - Accessible shortcut overlay

   Triggered by pressing '?' key. Shows available keyboard shortcuts.
   Dismissible via Escape key or clicking outside the card.
   ========================================================================== */

/* Overlay - semi-transparent backdrop */
.keyboard-help-overlay {
    position: fixed;
    inset: 0;
    background: light-dark(rgba(26, 26, 26, 0.5), rgba(0, 0, 0, 0.7));
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: var(--z-modal);
    opacity: 0;
    visibility: hidden;
    transition: opacity var(--transition-fast), visibility var(--transition-fast);
}

.keyboard-help-overlay[data-visible="true"] {
    opacity: 1;
    visibility: visible;
}

/* Card - centered content container */
.keyboard-help-card {
    position: relative;
    background: var(--background-body);
    border: var(--border-width) solid var(--border-color);
    padding: var(--space-xl);
    max-width: 320px;
    width: calc(100% - var(--space-xl) * 2);
    box-shadow: var(--shadow-content-light);
    transform: translateY(var(--space-sm));
    transition: transform var(--transition-fast);
}

.keyboard-help-card:focus {
    outline: none;
}

.keyboard-help-overlay[data-visible="true"] .keyboard-help-card {
    transform: translateY(0);
}

/* Heading */
.keyboard-help-heading {
    font-family: var(--font-heading);
    font-size: var(--font-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--text-primary);
    margin: 0 0 var(--space-lg) 0;
    letter-spacing: var(--letter-spacing-tight-md);
}

/* Shortcut list */
.keyboard-help-list {
    margin: 0;
    padding: 0;
}

.keyboard-help-item {
    display: flex;
    align-items: baseline;
    gap: var(--space-md);
    margin-bottom: var(--space-sm);
}

.keyboard-help-item:last-child {
    margin-bottom: 0;
}

.keyboard-help-item dt {
    flex-shrink: 0;
}

.keyboard-help-item dd {
    margin: 0;
    color: var(--text-secondary);
    font-size: var(--font-base);
}

/* Keyboard key styling */
.keyboard-help-card kbd {
    display: inline-block;
    min-width: var(--kbd-min-width);
    padding: var(--space-label-gap) var(--space-xs);
    font-family: var(--font-monospace);
    font-size: var(--font-sm);
    font-weight: var(--font-weight-medium);
    text-align: center;
    color: var(--text-primary);
    background: var(--background-card);
    border: var(--border-width) solid var(--border-color);
    border-radius: var(--border-radius-interactive);
}

/* Dismiss hint */
.keyboard-help-dismiss {
    margin: var(--space-lg) 0 0 0;
    padding-top: var(--space-md);
    border-top: var(--border-width) solid var(--border-color);
    font-size: var(--font-sm);
    color: var(--text-meta);
    text-align: center;
}

.keyboard-help-dismiss kbd {
    font-size: var(--font-xs);
    padding: 0.125rem var(--space-label-gap);
    min-width: auto;
}

/* Reduced motion - instant transitions */
@media (prefers-reduced-motion: reduce) {
    .keyboard-help-overlay,
    .keyboard-help-card {
        transition: none;
    }
}


/* ==========================================================================
   21. BLOCK EASTER EGG - Mempool next block visualization

   Hidden feature: type 'block' to show live mempool.space data.
   3D block flies from home-square to center with real-time fee info.
   ========================================================================== */

/* Block face tokens defined in :root section above */

.mempool-block-fee {
    font-size: var(--font-base);
    margin-bottom: var(--space-label-gap);
}

.mempool-block-range {
    font-size: var(--font-sm);
    font-weight: var(--font-weight-normal);
    opacity: var(--opacity-muted);
    margin-bottom: var(--space-xs);
}

.mempool-block-total {
    font-size: var(--font-2xl);
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--space-xs);
}

.mempool-block-count {
    font-size: var(--font-sm);
    opacity: var(--opacity-high);
    margin-bottom: var(--space-label-gap);
}

.mempool-block-time {
    font-size: var(--font-sm);
    opacity: var(--opacity-high);
}

.mempool-block-height {
    font-size: var(--font-custom-32);
    font-weight: var(--font-weight-bold);
    letter-spacing: var(--letter-spacing-tight-md);
}
